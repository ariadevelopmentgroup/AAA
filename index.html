<!DOCTYPE html>
<html lang="hy">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyUI Պատվերի Ֆորմա</title>
    <link rel="stylesheet" type="text/css" href="https://www.jeasyui.com/easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="https://www.jeasyui.com/easyui/themes/icon.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://www.jeasyui.com/easyui/jquery.easyui.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 15px;
            background: #f5f5f5;
            font-family: Arial, sans-serif;
        }
        .form-container {
            max-width: 800px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .price-display {
            font-size: 1.5em;
            font-weight: bold;
            color: #2196F3;
            margin-top: 10px;
        }
        @media screen and (max-width: 600px) {
            .fitem label {
                display: block;
                margin-bottom: 5px;
            }
        }
    </style>
</head>
<body>
<div class="form-container">
    <h2>Պատվերի Ֆորմա</h2>
    <form id="orderForm" class="easyui-form" method="post" data-options="novalidate:true">
        <div class="fitem">
            <label>Անուն:</label>
            <input class="easyui-textbox" name="name" style="width:100%" required>
        </div>
        <div class="fitem">
            <label>Հեռախոս (+374):</label>
            <input class="easyui-textbox" id="phone" name="phone" style="width:100%" required 
                   data-options="prompt:'Մուտքագրեք 8 նիշ',validType:'phoneCheck'">
        </div>
        <div class="fitem">
            <label>Հասցե:</label>
            <input class="easyui-textbox" name="address" style="width:100%" required>
        </div>
        <div class="fitem">
            <label>Կառույց:</label>
            <select id="buildingType" class="easyui-combobox" name="buildingType" style="width:100%">
                <option value="house">Տուն</option>
                <option value="apartment">Բնակարան</option>
            </select>
        </div>

        <div id="houseFields" style="display:none;">
            <div class="fitem">
                <label>Տան համար:</label>
                <input class="easyui-numberbox" name="houseNumber" style="width:100%">
            </div>
        </div>

        <div id="apartmentFields" style="display:none;">
            <div class="fitem"><label>Շենքի համար:</label><input class="easyui-numberbox" name="buildingNumber" style="width:100%"></div>
            <div class="fitem"><label>Մուտքի համար:</label><input class="easyui-numberbox" name="entranceNumber" style="width:100%"></div>
            <div class="fitem"><label>Դամաֆոնի կոդ:</label><input class="easyui-textbox" name="intercomCode" style="width:100%"></div>
            <div class="fitem"><label>Հարկ:</label><input class="easyui-numberbox" name="floor" style="width:100%"></div>
            <div class="fitem"><label>Բնակարանի համար:</label><input class="easyui-numberbox" name="apartmentNumber" style="width:100%"></div>
        </div>

        <div class="fitem">
            <label>Ծառայության տեսակ:</label>
            <select id="serviceType" class="easyui-combobox" name="serviceType" style="width:100%">
                <option value="1000">Ծառայություն 1 - 1000֏</option>
                <option value="2000">Ծառայություն 2 - 2000֏</option>
                <option value="3000">Ծառայություն 3 - 3000֏</option>
            </select>
        </div>

        <div class="fitem">
            <label>ՔՄ:</label>
            <input class="easyui-numberbox" id="sqm" name="sqm" style="width:100%">
        </div>
        <div class="price-display" id="totalPrice">Գին: 0֏</div>

        <div style="margin-top:15px;">
            <a href="javascript:void(0)" id="saveTemplate" class="easyui-linkbutton" data-options="iconCls:'icon-save'" style="width:48%">Պահպանել շաբլոնը</a>
            <a href="javascript:void(0)" id="submitForm" class="easyui-linkbutton" data-options="iconCls:'icon-ok'" style="width:48%">Ուղարկել</a>
        </div>
    </form>
</div>

<script>
    $.extend($.fn.validatebox.defaults.rules, {
        phoneCheck: {
            validator: function(value){
                return /^\d{8}$/.test(value);
            },
            message: 'Մուտքագրեք ճիշտ հեռախոսահամար (8 նիշ):'
        }
    });

    $('#buildingType').combobox({
        onChange: function(value){
            if(value === 'house'){
                $('#houseFields').show();
                $('#apartmentFields').hide();
            } else {
                $('#houseFields').hide();
                $('#apartmentFields').show();
            }
        }
    });

    function updatePrice(){
        let sqm = parseFloat($('#sqm').numberbox('getValue')) || 0;
        let pricePerSqm = parseFloat($('#serviceType').combobox('getValue')) || 0;
        $('#totalPrice').text('Գին: ' + (sqm * pricePerSqm) + '֏');
    }
    $('#sqm, #serviceType').on('change', updatePrice);

    $('#saveTemplate').click(function(){
        let formData = $('#orderForm').serializeArray();
        localStorage.setItem('orderTemplate', JSON.stringify(formData));
        $.messager.alert('Պահպանված է', 'Շաբլոնը հաջողությամբ պահպանվեց');
    });

    $(document).ready(function(){
        let savedData = localStorage.getItem('orderTemplate');
        if(savedData){
            savedData = JSON.parse(savedData);
            savedData.forEach(item => {
                $('[name="'+item.name+'"]').val(item.value);
            });
            updatePrice();
        }
    });

    $('#submitForm').click(function(){
        if($('#orderForm').form('validate')){
            let formData = $('#orderForm').serializeArray();
            
            // Google Sheets API Integration
            fetch("YOUR_GOOGLE_SCRIPT_WEB_APP_URL", {
                method: "POST",
                body: JSON.stringify(formData),
                headers: { "Content-Type": "application/json" }
            }).then(res => {
                $.messager.alert('Հաջողություն', 'Շնորհակալություն, Ձեր պատվերը հաջողությամբ գրանցվեց');
                setTimeout(()=> location.reload(), 3000);
            });
        }
    });
</script>
</body>
</html>
