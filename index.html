<!DOCTYPE html>
<html lang="hy">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Responsive CMS</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios@1.4.0/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/typography@0.5.9/dist/typography.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-quill@2.0.0/dist/react-quill.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/react-quill@2.0.0/dist/quill.snow.css" rel="stylesheet">
  <style>
    body { background-color: #1a1a1a; color: #ffffff; }
    .ql-editor { background-color: #2d2d2d; color: #ffffff; }
    .ql-toolbar { background-color: #1a1a1a; }
    .custom-button { background-color: #ffffff; color: #000000; padding: 8px 16px; border-radius: 4px; }
    .custom-button:hover { background-color: #e5e5e5; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    const CMSApp = () => {
      const [isAuthenticated, setIsAuthenticated] = useState(false);
      const [content, setContent] = useState([]);
      const [newContent, setNewContent] = useState('');
      const [searchTerm, setSearchTerm] = useState('');
      const [selectedFiles, setSelectedFiles] = useState([]);
      const [scheduledPosts, setScheduledPosts] = useState([]);
      const [comments, setComments] = useState([]);
      const [users, setUsers] = useState([]);
      const [analytics, setAnalytics] = useState(null);

      // GitHub Authentication
      const handleGitHubLogin = () => {
        window.location.href = 'https://github.com/login/oauth/authorize?client_id=YOUR_GITHUB_CLIENT_ID&scope=repo';
      };

      // Fetch content from GitHub
      const fetchContent = async () => {
        try {
          const response = await axios.get('https://api.github.com/repos/OWNER/REPO/contents/content', {
            headers: { Authorization: 'Bearer YOUR_GITHUB_TOKEN' }
          });
          setContent(response.data);
        } catch (error) {
          console.error('Error fetching content:', error);
        }
      };

      // Visual Editor with React Quill
      const handleEditorChange = (value) => {
        setNewContent(value);
      };

      // Media Manager
      const handleFileUpload = (event) => {
        const files = Array.from(event.target.files);
        setSelectedFiles(files);
        // Simulate upload to AWS S3 or Cloudflare R2
        console.log('Uploading files:', files);
      };

      // Search Functionality
      const filteredContent = content.filter(item =>
        item.name.toLowerCase().includes(searchTerm.toLowerCase())
      );

      // Schedule Content
      const scheduleContent = (content, date) => {
        setScheduledPosts([...scheduledPosts, { content, date }]);
      };

      // Invite Users
      const inviteUser = (email) => {
        setUsers([...users, { email, role: 'editor' }]);
        console.log(`Invited user: ${email}`);
      };

      // Permissions
      const updatePermissions = (user, role) => {
        setUsers(users.map(u => u.email === user.email ? { ...u, role } : u));
      };

      // Analytics Integration
      const fetchAnalytics = () => {
        // Simulate Google Analytics or Cloudflare Analytics
        setAnalytics({ pageViews: 1000, uniqueVisitors: 500 });
      };

      // Comments
      const addComment = (contentId, comment) => {
        setComments([...comments, { contentId, comment, user: 'currentUser' }]);
      };

      useEffect(() => {
        if (isAuthenticated) {
          fetchContent();
          fetchAnalytics();
        }
      }, [isAuthenticated]);

      return (
        <div className="container mx-auto p-4">
          {!isAuthenticated ? (
            <div className="flex justify-center items-center h-screen">
              <button onClick={handleGitHubLogin} className="custom-button">Մուտք գործել GitHub-ով</button>
            </div>
          ) : (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              {/* Visual Editor */}
              <div className="bg-gray-800 p-4 rounded">
                <h2 className="text-xl font-bold mb-2">Տեքստային խմբագրիչ</h2>
                <ReactQuill theme="snow" value={newContent} onChange={handleEditorChange} />
                <button onClick={() => console.log('Saving content:', newContent)} className="custom-button mt-2">Պահպանել</button>
              </div>

              {/* Media Manager */}
              <div className="bg-gray-800 p-4 rounded">
                <h2 className="text-xl font-bold mb-2">Մեդիա կառավարիչ</h2>
                <input type="file" multiple onChange={handleFileUpload} className="mb-2" />
                <div>
                  {selectedFiles.map((file, index) => (
                    <p key={index}>{file.name}</p>
                  ))}
                </div>
              </div>

              {/* Search */}
              <div className="bg-gray-800 p-4 rounded">
                <h2 className="text-xl font-bold mb-2">Որոնում</h2>
                <input
                  type="text"
                  placeholder="Որոնել բովանդակություն..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="w-full p-2 bg-gray-700 rounded text-white"
                />
                <ul className="mt-2">
                  {filteredContent.map(item => (
                    <li key={item.sha}>{item.name}</li>
                  ))}
                </ul>
              </div>

              {/* Scheduling */}
              <div className="bg-gray-800 p-4 rounded">
                <h2 className="text-xl font-bold mb-2">Հաշվարկված հրապարակում</h2>
                <input type="datetime-local" className="w-full p-2 bg-gray-700 rounded text-white mb-2" />
                <button onClick={() => scheduleContent(newContent, new Date())} className="custom-button">Հաշվարկել</button>
              </div>

              {/* Permissions */}
              <div className="bg-gray-800 p-4 rounded">
                <h2 className="text-xl font-bold mb-2">Թույլտվություններ</h2>
                {users.map(user => (
                  <div key={user.email} className="flex justify-between">
                    <span>{user.email}</span>
                    <select
                      value={user.role}
                      onChange={(e) => updatePermissions(user, e.target.value)}
                      className="bg-gray-700 text-white p-1 rounded"
                    >
                      <option value="editor">Խմբագիր</option>
                      <option value="admin">Ադմին</option>
                    </select>
                  </div>
                ))}
                <input
                  type="email"
                  placeholder="Հաշիվը հրավիրելու համար"
                  onChange={(e) => inviteUser(e.target.value)}
                  className="w-full p-2 bg-gray-700 rounded text-white mt-2"
                />
              </div>

              {/* Analytics */}
              <div className="bg-gray-800 p-4 rounded">
                <h2 className="text-xl font-bold mb-2">Վերլուծություն</h2>
                {analytics && (
                  <div>
                    <p>Էջի դիտումներ: {analytics.pageViews}</p>
                    <p>Եզակի այցելուներ: {analytics.uniqueVisitors}</p>
                  </div>
                )}
              </div>

              {/* Comments */}
              <div className="bg-gray-800 p-4 rounded">
                <h2 className="text-xl font-bold mb-2">Մեկնաբանություններ</h2>
                <input
                  type="text"
                  placeholder="Ավելացնել մեկնաբանություն..."
                  onChange={(e) => addComment('contentId', e.target.value)}
                  className="w-full p-2 bg-gray-700 rounded text-white mb-2"
                />
                {comments.map((comment, index) => (
                  <p key={index}>{comment.comment} - {comment.user}</p>
                ))}
              </div>
            </div>
          )}
        </div>
      );
    };

    ReactDOM.render(<CMSApp />, document.getElementById('root'));
  </script>
</body>
</html>
